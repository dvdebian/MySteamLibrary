<Window x:Class="MySteamLibrary.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="My Steam Library" 
        Icon="MySteamLibrary.ico"
        Height="980" 
        Width="760"
        MinHeight="980" 
        MinWidth="760"
        SizeChanged="Window_SizeChanged"
        Background="#1b2838">

    <Window.Resources>
        <!-- SECTION: SHARED UI STYLES -->

        <!-- Style for the View Mode RadioButtons (List, Grid, Cover) -->
        <Style x:Key="ViewModeButtonStyle" TargetType="RadioButton">
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <Border x:Name="BtnBorder" Background="#2a475e" CornerRadius="4" Padding="15,8,15,8" Margin="0,0,10,0" Cursor="Hand" BorderThickness="1" BorderBrush="#171a21">
                            <ContentPresenter x:Name="BtnContent" HorizontalAlignment="Center" VerticalAlignment="Center">
                                <ContentPresenter.Resources>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Foreground" Value="#c7d5e0"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                    </Style>
                                </ContentPresenter.Resources>
                            </ContentPresenter>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="BtnBorder" Property="Background" Value="#3d6c8d"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="BtnBorder" Property="Background" Value="#67c1f5"/>
                                <Setter TargetName="BtnBorder" Property="BorderBrush" Value="#67c1f5"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Style for Steam-themed Buttons (Refresh, Settings, Save) -->
        <Style x:Key="SteamActionButtonStyle" TargetType="Button">
            <Setter Property="Height" Value="32"/>
            <Setter Property="Padding" Value="10,0"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="btnBorder" 
                                Background="{TemplateBinding Background}" 
                                CornerRadius="3" 
                                BorderBrush="#3d6c8d" 
                                BorderThickness="1">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#3d6c8d"/>
                                <Setter Property="Foreground" Value="White"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="btnBorder" Property="Background" Value="#67c1f5"/>
                                <Setter Property="Foreground" Value="#171a21"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Custom Steam-styled ScrollBar -->
        <Style TargetType="ScrollBar">
            <Setter Property="Background" Value="#1b2838"/>
            <Setter Property="Width" Value="10"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="ScrollBar">
                        <Grid x:Name="Bg" Background="Transparent" SnapsToDevicePixels="true">
                            <Track x:Name="PART_Track" IsDirectionReversed="true" IsEnabled="{TemplateBinding IsEnabled}">
                                <Track.Thumb>
                                    <Thumb x:Name="Thumb">
                                        <Thumb.Template>
                                            <ControlTemplate TargetType="Thumb">
                                                <Border Background="#4b6174" CornerRadius="5" Margin="2,0,2,0"/>
                                            </ControlTemplate>
                                        </Thumb.Template>
                                    </Thumb>
                                </Track.Thumb>
                            </Track>
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="true">
                                <Setter TargetName="Thumb" Property="Background" Value="#67c1f5" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </Window.Resources>

    <Grid>
        <!-- SECTION: DYNAMIC BACKGROUND LAYER -->
        <Grid Grid.RowSpan="3">
            <!-- Blurred background image that changes based on selection (Cover Mode only) -->
            <Image x:Name="BackgroundImage" 
                   Source="{Binding SelectedItem.DisplayImage, ElementName=GamesListView, NotifyOnTargetUpdated=True}"                 
                   Stretch="UniformToFill"
                   HorizontalAlignment="Center"
                   VerticalAlignment="Center">
                <Image.Effect>
                    <BlurEffect Radius="80" KernelType="Gaussian"/>
                </Image.Effect>
                <Image.Style>
                    <Style TargetType="Image">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <EventTrigger RoutedEvent="Binding.TargetUpdated">
                                <BeginStoryboard>
                                    <Storyboard>
                                        <DoubleAnimation Storyboard.TargetProperty="Opacity" From="0" To="1" Duration="0:0:0.8"/>
                                    </Storyboard>
                                </BeginStoryboard>
                            </EventTrigger>
                        </Style.Triggers>
                    </Style>
                </Image.Style>
            </Image>

            <!-- Dark overlay tint for background readability -->
            <Border Background="Black">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Opacity" Value="0"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True">
                                <Setter Property="Opacity" Value="0.5"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>
            <Border Background="Black">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Opacity" Value="0"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True">
                                <Setter Property="Opacity" Value="0.5"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
            </Border>
        </Grid>

        <!-- SECTION: MAIN UI CONTENT -->
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <!-- Header / Toolbar -->
                <RowDefinition Height="*"/>
                <!-- Game List -->
                <RowDefinition Height="Auto"/>
                <!-- Details Footer -->
            </Grid.RowDefinitions>

            <!-- HEADER AREA: TITLE, CONTROLS, AND SEARCH -->
            <Border Grid.Row="0" Background="#171a21" Padding="15" CornerRadius="8" Margin="0,0,0,20">
                <StackPanel>
                    <Grid Margin="0,0,0,15">
                        <TextBlock Text="MY STEAM LIBRARY" FontSize="22" FontWeight="ExtraBold" Foreground="White"/>
                        <TextBlock x:Name="CountLabel" Text="0 Games" Foreground="#56707f" HorizontalAlignment="Right" VerticalAlignment="Bottom"/>
                    </Grid>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <StackPanel Orientation="Horizontal">
                            <RadioButton x:Name="ListModeBtn" Content="LIST" IsChecked="True" GroupName="ViewModes" Style="{StaticResource ViewModeButtonStyle}" Checked="Mode_Changed"/>
                            <RadioButton x:Name="GridModeBtn" Content="GRID" GroupName="ViewModes" Style="{StaticResource ViewModeButtonStyle}" Checked="Mode_Changed"/>
                            <RadioButton x:Name="CoverModeBtn" Content="COVER" GroupName="ViewModes" Style="{StaticResource ViewModeButtonStyle}" Checked="Mode_Changed"/>
                            <RadioButton x:Name="CarouselModeBtn" Content="CAROUSEL" GroupName="ViewModes" Style="{StaticResource ViewModeButtonStyle}" Checked="Mode_Changed"/>
                        </StackPanel>
                        <StackPanel Orientation="Horizontal" HorizontalAlignment="Right" VerticalAlignment="Center">
                            <Button Click="LoadGames_Click" Style="{StaticResource SteamActionButtonStyle}" Content="REFRESH" Width="100" Margin="0,0,10,0" Background="#2a475e" Foreground="#67c1f5" />
                            <Button Click="OpenSettings_Click" Style="{StaticResource SteamActionButtonStyle}"  Content="⚙" Width="35" FontSize="18" Background="#2a475e" Foreground="#67c1f5" />
                        </StackPanel>
                    </Grid>

                    <Grid Margin="0,15,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="SEARCH" VerticalAlignment="Center" Margin="0,0,15,0" Foreground="#67c1f5" FontWeight="Bold" FontSize="11"/>

                        <Grid Grid.Column="1">
                            <TextBox x:Name="SearchTextBox" 
                                     Padding="10,10,35,10" 
                                     Background="#2a475e" 
                                     Foreground="White" 
                                     BorderThickness="0" 
                                     TextChanged="SearchTextBox_TextChanged"/>

                            <Button x:Name="ClearSearchBtn"
                                    HorizontalAlignment="Right"
                                    VerticalAlignment="Center"
                                    Margin="0,0,10,0"
                                    Width="18"
                                    Height="18"
                                    Background="Transparent"
                                    BorderThickness="0"
                                    Cursor="Hand"
                                    Visibility="Collapsed"
                                    Click="ClearSearchBtn_Click">
                                <Button.Template>
                                    <ControlTemplate TargetType="Button">
                                        <Grid Background="Transparent">
                                            <Ellipse x:Name="Circle" Fill="#4b6171" Opacity="0.6"/>

                                            <Viewbox Margin="5">
                                                <Path Data="M 0,0 L 10,10 M 0,10 L 10,0" 
                                                      Stroke="White" 
                                                      StrokeThickness="2" 
                                                      StrokeStartLineCap="Round" 
                                                      StrokeEndLineCap="Round"/>
                                            </Viewbox>
                                        </Grid>
                                        <ControlTemplate.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter TargetName="Circle" Property="Fill" Value="#67c1f5"/>
                                                <Setter TargetName="Circle" Property="Opacity" Value="1"/>
                                            </Trigger>
                                        </ControlTemplate.Triggers>
                                    </ControlTemplate>
                                </Button.Template>
                            </Button>
                        </Grid>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- MAIN LISTVIEW: DISPLAYS GAMES -->
            <ListView x:Name="GamesListView" 
                      Grid.Row="1"                    
                      RequestBringIntoView="GamesListView_RequestBringIntoView"       
                      Background="Transparent"                                     
                      BorderThickness="0" 
                      SelectionMode="Single"
                      SelectionChanged="GamesListView_SelectionChanged"
                      PreviewMouseLeftButtonDown="GamesListView_PreviewMouseLeftButtonDown"
                      ScrollViewer.CanContentScroll="False" 
                      ClipToBounds="False"
                      PreviewMouseWheel="GamesListView_PreviewMouseWheel"
                      VirtualizingPanel.IsVirtualizing="True"
                      VirtualizingPanel.VirtualizationMode="Recycling"
                      VerticalAlignment="Stretch" 
                      VerticalContentAlignment="Stretch"
                      HorizontalContentAlignment="Stretch">

                <!-- ListView Layout switching logic (List vs Grid vs Cover) -->
                <ListView.Style>
                    <Style TargetType="ListView">
                        <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Disabled"/>
                        <Setter Property="ClipToBounds" Value="False"/>
                        <Setter Property="ItemsPanel">
                            <Setter.Value>
                                <ItemsPanelTemplate>
                                    <StackPanel IsItemsHost="True" Orientation="Vertical" />
                                </ItemsPanelTemplate>
                            </Setter.Value>
                        </Setter>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=GridModeBtn}" Value="True">
                                <Setter Property="ItemsPanel">
                                    <Setter.Value>
                                        <ItemsPanelTemplate>
                                            <WrapPanel IsItemsHost="True" Orientation="Horizontal" HorizontalAlignment="Left" />
                                        </ItemsPanelTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True">
                                <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel"/>
                                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
                                <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                <Setter Property="ItemsPanel">
                                    <Setter.Value>
                                        <ItemsPanelTemplate>
                                            <StackPanel IsItemsHost="True" Orientation="Horizontal" VerticalAlignment="Center">
                                                <StackPanel.Resources>
                                                    <Style TargetType="StackPanel">
                                                        <Setter Property="Margin" Value="0"/>
                                                    </Style>
                                                </StackPanel.Resources>
                                            </StackPanel>
                                        </ItemsPanelTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True">
                                <Setter Property="VirtualizingPanel.ScrollUnit" Value="Pixel"/>
                                <Setter Property="VirtualizingPanel.IsVirtualizing" Value="False"/>
                                <Setter Property="ScrollViewer.HorizontalScrollBarVisibility" Value="Hidden"/>
                                <Setter Property="ScrollViewer.VerticalScrollBarVisibility" Value="Disabled"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                <Setter Property="ItemsPanel">
                                    <Setter.Value>
                                        <ItemsPanelTemplate>
                                            <StackPanel IsItemsHost="True" Orientation="Horizontal" VerticalAlignment="Center"/>
                                        </ItemsPanelTemplate>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListView.Style>

                <!-- STYLE FOR LISTVIEW ITEMS: ZOOMING AND Z-INDEX -->
                <ListView.ItemContainerStyle>
                    <Style TargetType="ListViewItem">
                        <Setter Property="ClipToBounds" Value="False"/>
                        <Setter Property="Background" Value="Transparent"/>
                        <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                        <EventSetter Event="MouseEnter" Handler="ListViewItem_MouseEnter"/>
                        <Setter Property="Template">
                            <Setter.Value>
                                <ControlTemplate TargetType="ListViewItem">
                                    <ContentPresenter />
                                </ControlTemplate>
                            </Setter.Value>
                        </Setter>
                        <Setter Property="RenderTransform">
                            <Setter.Value>
                                <ScaleTransform ScaleX="1" ScaleY="1"/>
                            </Setter.Value>
                        </Setter>
                        <!-- The 'Sweet Spot' origin to avoid clipping -->
                        <Setter Property="RenderTransformOrigin" Value="0.3,0.2"/>
                        <Style.Triggers>
                            <Trigger Property="IsSelected" Value="True">
                                <Setter Property="Panel.ZIndex" Value="100"/>
                            </Trigger>
                            <!-- Zoom Animation Trigger (Disabled in List Mode) -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource Self}}" Value="True"/>
                                    <Condition Binding="{Binding IsChecked, ElementName=ListModeBtn}" Value="False"/>
                                </MultiDataTrigger.Conditions>
                                <MultiDataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.15" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.15" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.EnterActions>
                                <MultiDataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleX)" To="1.0" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetProperty="(UIElement.RenderTransform).(ScaleTransform.ScaleY)" To="1.0" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.ExitActions>
                            </MultiDataTrigger>
                        </Style.Triggers>
                    </Style>
                </ListView.ItemContainerStyle>

                <!-- ITEM TEMPLATE: VISUAL DESIGN OF THE GAME CARD -->
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Border x:Name="BaseBorder" RenderTransformOrigin="0.5,0.5" Background="#233c51" CornerRadius="12" Padding="12" Margin="5" BorderThickness="1" BorderBrush="Transparent" CacheMode="BitmapCache">
                            <Border.Effect>
                                <DropShadowEffect BlurRadius="15" ShadowDepth="4" Opacity="0.5" Color="Black"/>
                            </Border.Effect>
                            <Border.RenderTransform>
                                <TransformGroup>
                                    <SkewTransform AngleY="0"/>
                                    <ScaleTransform ScaleX="1" ScaleY="1"/>
                                    <TranslateTransform Y="0"/>
                                </TransformGroup>
                            </Border.RenderTransform>
                            <StackPanel>
                                <Grid x:Name="MainGrid">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto"/>
                                        <ColumnDefinition Width="*"/>
                                    </Grid.ColumnDefinitions>
                                    <!-- Game Cover Image -->
                                    <Border x:Name="ImageRoundingBorder" CornerRadius="8" ClipToBounds="True" Width="90" Height="135" Background="#171a21">
                                        <Image Source="{Binding DisplayImage, IsAsync=False}" 
                                               Stretch="Uniform" 
                                               RenderOptions.BitmapScalingMode="HighQuality" 
                                               ImageFailed="Image_ImageFailed" />
                                    </Border>
                                    
                                    <!-- Text Information (Name and Playtime) -->
                                    <StackPanel x:Name="TextPanel" Grid.Column="1" Margin="15,0,0,0" VerticalAlignment="Center">
                                        <TextBlock Text="{Binding Name}" FontSize="16" FontWeight="Bold" Foreground="White" TextWrapping="Wrap"/>
                                        <TextBlock Text="{Binding Playtime}" Foreground="#67c1f5" FontSize="13" Margin="0,5,0,0"/>
                                    </StackPanel>
                                </Grid>

                                <!-- Expandable Details Panel (Visible in List Mode selection) -->
                                <Grid x:Name="DetailsPanel" MaxHeight="0" Opacity="0">
                                    <StackPanel Margin="0,10,0,0">
                                        <Separator Background="#1b2838" Margin="0,0,0,10"/>
                                        <TextBlock Text="{Binding Description}" Foreground="White" FontSize="13" TextWrapping="Wrap" LineHeight="18" MaxWidth="800" HorizontalAlignment="Left" TextAlignment="Left"/>
                                    </StackPanel>
                                </Grid>
                            </StackPanel>
                        </Border>

                        <DataTemplate.Triggers>
                            <!-- Adjustments for Grid Mode -->
                            <DataTrigger Binding="{Binding IsChecked, ElementName=GridModeBtn}" Value="True">
                                <Setter TargetName="TextPanel" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Width" Value="140"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Height" Value="210"/>
                                <Setter TargetName="BaseBorder" Property="Width" Value="160"/>
                            </DataTrigger>
                            <!-- Adjustments for Cover Mode -->
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True">
                                <Setter TargetName="TextPanel" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="BaseBorder" Property="Width" Value="280"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Width" Value="260"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Height" Value="390"/>
                                <Setter TargetName="BaseBorder" Property="Margin" Value="40,5,40,5"/>
                                <Setter TargetName="BaseBorder" Property="Opacity" Value="0.6"/>
                            </DataTrigger>
                            <!-- Adjustments for Carrousel Mode -->
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True">
                                <Setter TargetName="TextPanel" Property="Visibility" Value="Collapsed"/>
                                <Setter TargetName="BaseBorder" Property="Width" Value="200"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Width" Value="180"/>
                                <Setter TargetName="ImageRoundingBorder" Property="Height" Value="270"/>
                                <Setter TargetName="BaseBorder" Property="RenderTransform">
                                    <Setter.Value>
                                        <TransformGroup>
                                            <SkewTransform AngleY="-10"/>
                                            <ScaleTransform ScaleX="0.9" ScaleY="1.0"/>
                                        </TransformGroup>
                                    </Setter.Value>
                                </Setter>
                            </DataTrigger>
                            <!-- Details Panel Animation logic -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListViewItem}}" Value="True"/>
                                    <Condition Binding="{Binding IsChecked, ElementName=ListModeBtn}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <MultiDataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="DetailsPanel" Storyboard.TargetProperty="MaxHeight" To="250" Duration="0:0:0.3"/>
                                            <DoubleAnimation Storyboard.TargetName="DetailsPanel" Storyboard.TargetProperty="Opacity" To="1" Duration="0:0:0.3"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.EnterActions>
                                <MultiDataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="DetailsPanel" Storyboard.TargetProperty="MaxHeight" To="0" Duration="0:0:0.2"/>
                                            <DoubleAnimation Storyboard.TargetName="DetailsPanel" Storyboard.TargetProperty="Opacity" To="0" Duration="0:0:0.2"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.ExitActions>
                                <Setter TargetName="BaseBorder" Property="Background" Value="#2a475e"/>
                            </MultiDataTrigger>
                            <!-- Selection highlight for Cover Mode -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListViewItem}}" Value="True"/>
                                    <Condition Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True"/>
                                </MultiDataTrigger.Conditions>
                                <Setter TargetName="BaseBorder" Property="Opacity" Value="1.0"/>
                                <Setter TargetName="BaseBorder" Property="BorderBrush" Value="#67c1f5"/>
                            </MultiDataTrigger>
                            <!-- Transformation for Carrousel Mode -->
                            <MultiDataTrigger>
                                <MultiDataTrigger.Conditions>
                                    <Condition Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True"/>
                                    <Condition Binding="{Binding IsSelected, RelativeSource={RelativeSource AncestorType=ListViewItem}}" Value="True"/>
                                </MultiDataTrigger.Conditions>

                                <MultiDataTrigger.EnterActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(SkewTransform.AngleY)" To="0" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleX)" To="1.2" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleY)" To="1.2" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="Opacity" To="1.0" Duration="0:0:0.4"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.EnterActions>

                                <MultiDataTrigger.ExitActions>
                                    <BeginStoryboard>
                                        <Storyboard>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[0].(SkewTransform.AngleY)" To="-15" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleX)" To="0.8" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="(UIElement.RenderTransform).(TransformGroup.Children)[1].(ScaleTransform.ScaleY)" To="0.8" Duration="0:0:0.4"/>
                                            <DoubleAnimation Storyboard.TargetName="BaseBorder" Storyboard.TargetProperty="Opacity" To="0.5" Duration="0:0:0.4"/>
                                        </Storyboard>
                                    </BeginStoryboard>
                                </MultiDataTrigger.ExitActions>
                                <Setter TargetName="BaseBorder" Property="BorderBrush" Value="#67c1f5"/>
                                <Setter TargetName="BaseBorder" Property="Panel.ZIndex" Value="1000"/>
                            </MultiDataTrigger>
                        </DataTemplate.Triggers>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>

            <!-- FOOTER AREA: DETAILED TEXT (Cover Mode Only) -->
            <Border Grid.Row="2" Background="Transparent" Padding="10">
                <Border.Style>
                    <Style TargetType="Border">
                        <Setter Property="Visibility" Value="Collapsed"/>
                        <Setter Property="Height" Value="0"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CoverModeBtn}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Setter Property="Height" Value="200"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding IsChecked, ElementName=CarouselModeBtn}" Value="True">
                                <Setter Property="Visibility" Value="Visible"/>
                                <Setter Property="Height" Value="200"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Border.Style>
                <StackPanel DataContext="{Binding ElementName=GamesListView, Path=SelectedItem}" MaxWidth="800" VerticalAlignment="Top">
                    <TextBlock Text="{Binding Name}" FontSize="24" FontWeight="Bold" Foreground="White" HorizontalAlignment="Center" TextAlignment="Center" TextWrapping="Wrap" MaxHeight="65"/>
                    <TextBlock Text="{Binding Playtime, StringFormat='Played: {0}'}" FontSize="14" Foreground="#67c1f5" HorizontalAlignment="Center" Margin="0,2,0,5"/>
                    <TextBlock Text="{Binding Description}" FontSize="13" Foreground="#c7d5e0" TextWrapping="Wrap" TextAlignment="Left" LineHeight="18" MaxHeight="80"/>
                </StackPanel>
            </Border>
        </Grid>

        <!-- SECTION: SETTINGS OVERLAY -->
        <Grid x:Name="SettingsOverlay" Visibility="Collapsed" Background="#CC171a21" Panel.ZIndex="1000">
            <Border Background="#2a475e" Width="400" Height="380" CornerRadius="15" VerticalAlignment="Center">
                <StackPanel Margin="30">
                    <TextBlock Text="SETTINGS" Foreground="White" FontSize="20" FontWeight="Bold" Margin="0,0,0,20"/>

                    <TextBlock Text="Steam API Key" Foreground="#67c1f5" Margin="0,5,0,5"/>
                    <TextBox x:Name="ApiKeyInput" Height="30" Background="#1b2838" Foreground="White" BorderBrush="#67c1f5" VerticalContentAlignment="Center" Padding="5,0"/>

                    <TextBlock Text="Steam ID" Foreground="#67c1f5" Margin="0,15,0,5"/>
                    <TextBox x:Name="SteamIdInput" Height="30" Background="#1b2838" Foreground="White" BorderBrush="#67c1f5" VerticalContentAlignment="Center" Padding="5,0"/>

                    <Button Content="Clear Image Cache" Click="ClearCache_Click" Height="30" Margin="0,20,0,0" Background="#3d4450" Foreground="#67c1f5" BorderBrush="#67c1f5" BorderThickness="1" Cursor="Hand">
                        <Button.Style>
                            <Style TargetType="Button" BasedOn="{StaticResource SteamActionButtonStyle}">
                                <Style.Triggers>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter Property="Background" Value="#4e545f"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </Button.Style>
                    </Button>

                    <Grid Margin="0,25,0,0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        <Button Content="Cancel" Click="CancelSettings_Click" Grid.Column="0" Margin="0,0,5,0" Height="35" Style="{StaticResource SteamActionButtonStyle}" Background="#3d4450" Foreground="#afb2b8" BorderBrush="#4e545f" BorderThickness="1" Cursor="Hand" IsCancel="True"/>
                        <Button Content="Save &amp; Close" Click="SaveSettings_Click" Grid.Column="1" Margin="5,0,0,0" Height="35" Background="#5c7e10" Foreground="#d2efa9" BorderBrush="#6b8f13" BorderThickness="1" Style="{StaticResource SteamActionButtonStyle}" FontWeight="Bold" Cursor="Hand"/>
                    </Grid>
                </StackPanel>
            </Border>
        </Grid>
    </Grid>
</Window>